{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://1er-degre.fr/schemas/mail-log.json",
  "title": "MailLog",
  "description": "Email delivery tracking and analytics log",
  "type": "object",
  "properties": {
    "id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique mail log identifier",
      "readOnly": true
    },
    "scheduled_email_id": {
      "type": ["string", "null"],
      "format": "uuid",
      "description": "Reference to scheduled email if applicable"
    },
    "recipient_email": {
      "type": "string",
      "format": "email",
      "description": "Recipient email address"
    },
    "recipient_user_id": {
      "type": ["string", "null"],
      "format": "uuid",
      "description": "Reference to recipient user if registered"
    },
    "subject": {
      "type": "string",
      "description": "Email subject line"
    },
    "delivery_status": {
      "type": "string",
      "enum": ["queued", "sent", "delivered", "bounced", "complained", "failed"],
      "description": "Email delivery tracking status"
    },
    "sent_at": {
      "type": ["string", "null"],
      "format": "date-time",
      "description": "When email was sent to provider"
    },
    "delivered_at": {
      "type": ["string", "null"],
      "format": "date-time",
      "description": "When email was delivered to recipient"
    },
    "opened_at": {
      "type": ["string", "null"],
      "format": "date-time",
      "description": "When email was first opened by recipient"
    },
    "clicked_at": {
      "type": ["string", "null"],
      "format": "date-time",
      "description": "When links in email were first clicked"
    },
    "bounced_at": {
      "type": ["string", "null"],
      "format": "date-time",
      "description": "When email bounced"
    },
    "bounce_reason": {
      "type": ["string", "null"],
      "description": "Reason for bounce if applicable"
    },
    "error_message": {
      "type": ["string", "null"],
      "description": "Error details if delivery failed"
    },
    "provider_message_id": {
      "type": ["string", "null"],
      "description": "Email service provider's message identifier"
    },
    "tenant_id": {
      "type": "string",
      "description": "Tenant identifier for multi-tenant isolation",
      "default": "1er-Degr√©"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "Log entry creation timestamp",
      "readOnly": true
    },
    "updated_at": {
      "type": "string",
      "format": "date-time",
      "description": "Last update timestamp",
      "readOnly": true
    }
  },
  "required": [
    "recipient_email",
    "subject",
    "delivery_status"
  ]
}
